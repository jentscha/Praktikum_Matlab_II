% =================================================================================
% Hier auswählen, ob TUD-Design oder nicht
% =================================================================================
\newif\ifTUDdesign
\TUDdesigntrue					% TUD-Design
%\TUDdesignfalse				% Für Rechner ohne installierte TUDdesign-Pakete
% =================================================================================


% =================================================================================
% Hier Daten für studentische Arbeit eingeben
% =================================================================================
\newcommand{\SADATyp}{Praktikumsbericht}
\newcommand{\SADATitel}{Versuch II: Linearisierung, Steuerbarkeit und Beobachtbarkeit}
\newcommand{\SADAStadt}{Darmstadt}
\newcommand{\SADAAutor}{Andreas Jentsch, Ali Kerem Sacakli}
\newcommand{\SADABetreuer}{}
\newcommand{\SADABetreuerII}{}
\newcommand{\SADABetreuerIII}{}
\newcommand{\SADABegin}{}
\newcommand{\SADAAbgabe}{Praktikum Matlab/Simulink II}
\newcommand{\SADASeminar}{}
% =================================================================================


% =================================================================================
% Auswahl des IAT-Fachgebiets (rtm / rtp)
% =================================================================================
\newif\ifrtm
\rtmtrue	% rtm
%\rtmfalse	% rtp
% =================================================================================


% =================================================================================
% Erklärung, dass die Arbeit ohne Hilfe Dritter etc. erstellt wurde
% =================================================================================
\def\SADAVarianteErklaerung{ETIT}		% FB 18, Elektrotechnik
%\def\SADAVarianteErklaerung{MBDA}		% FB 16, Maschinenbau, Diplomarbeit
%\def\SADAVarianteErklaerung{MBSA}		% FB 16, Maschinenbau, Studienarbeit
% =================================================================================


% =================================================================================
% Ausnahmen von der automatischen Silbentrennung
% =================================================================================
\hyphenation{Aktu-ali-sie-rung Screen-shots Pa-rallel-ro-bo-ter Zu-stands-raum-mo-del-le nach-voll-zieh-bar Pro-jekt-se-mi-nar}
% =================================================================================


% =================================================================================
% Hier NIICHTS ändern!
% =================================================================================
\ifTUDdesign
	\documentclass[11pt, twoside, colorback, accentcolor=tud2c, nopartpage, bigchapter, fleqn, ngerman, longdoc]{tudreport}
\else
	\documentclass[11pt, a4paper, twoside, fleqn, ngerman]{scrreprt}
  % Für Entwurf auf Rechnern ohne installierte TUDdesign-Pakete	
	\usepackage{exscale}	% Korrektur math-Zeichen
	\usepackage{eurosym}
\fi
%eps-plot von Matlab in pdf umwandeln, um diese einbinden zu können
\usepackage{epstopdf}
%Paket listings für das Einbinden von Quelltext
\usepackage{listings}
%Stil Matlab_colored definieren
\lstdefinestyle{Matlab_colored}
{
	language = Matlab,
	tabsize = 4,
	framesep = 3mm,
	frame = tb,
	classoffset = 0,
	basicstyle = \ttfamily,
	keywordstyle = \bfseries\color[rgb]{0,0,1},
	commentstyle = \itshape\color[rgb]{0.133,0.545,0.133},
	stringstyle = \color[rgb]{0.672,0.126,0.941},
	extendedchars = true,
	breaklines = true,
	prebreak = \textrightarrow,
	postbreak = \textleftarrow,
	numbers = left,
	numberstyle = \tiny,
	stepnumber = 5
}


\input{common/includes.tex}				% verwendete Pakete einbinden
\input{common/setup.tex}					% LaTeX-Einstellungen
\input{common/commonmacros.tex}		% oft verwendete Befehle
% =================================================================================


% =================================================================================
% Hier beginnt das eigentliche Dokument
% =================================================================================

\begin{document}
%\input{common/preface.tex} % Titelseite, Aufgabenstellung, Erklärung, Abstract, Inhaltsverzeichnis, etc.
\maketitle

\setcounter{chapter}{2}

%Warum geht title/section nicht?
\section{Linearisierung}
Im folgenden Abschnitt wird die Funktion zur Linearisierung des Doppelpendel-Systems um einen Arbeitspunkt, sowie ihre Rückgabewerte an bestimmten Arbeitspunkten dokumentiert. Die Implementierung der Funktion ist in \autoref{Code_Linearisierung} aufgeführt.

Bevor das System linearisiert wird sind zwei Fragen zu klären:
\begin{enumerate}
	\item Welche Arbeitspunkte sind sinnvoll?
	\item Was bedeutet es physikalisch, wenn $M_{\textrm{AP}}$ ungleich null ist?
\end{enumerate}
Die Antworten lauten wie folgt:
\begin{enumerate}
	\item Es ist nur sinnvoll das System in Arbeitspunkten zu linearisieren, in denen es sowohl vollständig beobachtbar, als auch steuerbar ist.
	\item Bei der Größe $M_{\textrm{AP}}$ handelt es sich um den statischen Wert der Stellgröße $M$ im Arbeitspunkt. Ist diese ungleich null muss der Motor das Moment $M_{\textrm{}}$ 
\end{enumerate}

In dieser Aufgabe soll eine Funktion \verb|[A,B,C,D]=linearisierung(f,h,AP)| implementiert werden. Unter Vorgabe der Funktionen \verb|f, h| und des Arbeitspunktes \verb|AP| sollen die Matrizen der linearisierten Gleichungen in Zustandsraumdarstellung ausgegeben werden.

\lstinputlisting[style=Matlab_colored,caption={Das vorgegebene nichtlineare Modell}, label={Code_Linearisierung}]{Codes/nonlinear_model.m}
\lstinputlisting[style=Matlab_colored,caption={Code der Linearisierungsfunktion}, label={Code_Linearisierung}]{Codes/linearisierung.m}

Die Linearisierung um die Arbeitspunkte
\begin{align*}
	\textbf{x}_{\textrm{AP}_1} &= \begin{bmatrix} 0 & 0 & 0 & 0\end{bmatrix}\\
	\textbf{x}_{\textrm{AP}_2} &= \begin{bmatrix} \pi & 0 & \pi & 0\end{bmatrix}\\
	\textbf{x}_{\textrm{AP}_3} &= \begin{bmatrix} \pi/2 & 0 & \pi & 0 \end{bmatrix}
\end{align*}
ergibt für die allgemeine Zustandsraumdarstellung:
\begin{align*}
	\textbf{\.{x}} &= \textbf{Ax + Bu}\\
	\textbf{y} &= \textbf{Cx + Du}
\end{align*}
die folgenden Systemmatrizen:


\begin{itemize}
	\item $\vec{x}_{AP1}$=$\begin{pmatrix}
	0&0&0&0
	\end{pmatrix}$
	\begin{itemize}
		\item $\bf{A_{AP1}}= \begin{pmatrix}
		0&1&0&0\\
		-126,1286&0&63,0643&0\\
		0&0&0&1\\
		189,1929&0&-168,1714&0
		\end{pmatrix}$
		
		\item $\bf{B_{AP1}}= \begin{pmatrix}
		0\\
		142,8571\\
		0\\
		-214,2857
		\end{pmatrix}$
		
		\item $\bf{C_{AP1}}= \begin{pmatrix}
		1&0&0&0\\
		0&0&1&0
		\end{pmatrix}$
		
		\item $\bf{D_{AP1}}= \begin{pmatrix}
		0\\
		0
		\end{pmatrix}$
		
	\end{itemize}
	
	
	\item $\vec{x}_{AP2}$=$\begin{pmatrix}
	\pi&0&\pi&0
	\end{pmatrix}$
	
	\begin{itemize}
		\item $\bf{A_{AP2}}= \begin{pmatrix}
		0&1&0&0\\
		126.1286&0&-63,0643&0\\
		0&0&0&1\\
		-189,1929&0&168,1714&0
		\end{pmatrix}$
		
		\item $\bf{B_{AP2}}= \begin{pmatrix}
		0\\
		142,8571\\
		0\\
		-214,2857
		\end{pmatrix}$
		
		\item $\bf{C_{AP2}}= \begin{pmatrix}
		1&0&0&0\\
		0&0&1&0
		\end{pmatrix}$
		
		\item $\bf{D_{AP2}}= \begin{pmatrix}
		0\\
		0
		\end{pmatrix}$
		
	\end{itemize}
	
	
	
	\item $\vec{x}_{AP3}$=$\begin{pmatrix}
	\pi/2&0&\pi&0
	\end{pmatrix}$
	
	\begin{itemize}
		\item $\bf{A_{AP3}}= \begin{pmatrix}
		0&1&0&0\\
		0&0&0&0\\
		0&0&0&1\\
		0&0&73,575&0
		\end{pmatrix}$
		
		\item $\bf{B_{AP3}}= \begin{pmatrix}
		0\\
		62,5\\
		0\\
		0
		\end{pmatrix}$
		
		\item $\bf{C_{AP3}}= \begin{pmatrix}
		1&0&0&0\\
		0&0&1&0
		\end{pmatrix}$
		
		\item $\bf{D_{AP3}}= \begin{pmatrix}
		0\\
		0
		\end{pmatrix}$
		
	\end{itemize}
	
	
\end{itemize}


\paragraph{Was bedeutet es physikalisch, wenn $M_{AP}$ ungleich null ist?}
 (TEXT)


\section{Vergleich der linearisierten Modelle}
Die Eigenwerte der Zustandsraummodelle um die drei Arbeitspunkte lauten wie folgt:

	%align hatte hier einen Fehler verursacht
	$\vec{x}_{AP1}$=$\begin{pmatrix}
	0&0&0&0 \end{pmatrix}$:
	 \newline
	$\bf{\lambda_1}=\begin{pmatrix}
	16,0744i\\-16,0744i\\5,9929i\\-5,9929i
	\end{pmatrix}$ \newline
	
	$\vec{x}_{AP2}$=$\begin{pmatrix}
	\pi&0&\pi&0 \end{pmatrix}$: \newline
	$\bf{\lambda_2}=\begin{pmatrix}
	-16,0744\\16,0744\\5,9929\\-5,9929
	\end{pmatrix}$
	
	
	$\vec{x}_{AP_3}$=$\begin{pmatrix}\pi/2&0&\pi&0 \end{pmatrix}$: \newline
	$\bf{\lambda_3}=\begin{pmatrix}
	-8,5776\\8,5776\\0\\0
	\end{pmatrix}$	\\
	
	\paragraph{Welche Unterschiede zwischen den Eigenwerte der Zustandsraummodelle liegen vor und worauf sind diese zurückzuführen? Können Sie sich vorstellen, was sich ändern würde, wenn die Reibung berücksichtigt wäre?}
	(TEXT)

\section{Normalformen des Zustandsraummodelles}
Es soll eine Funktion \verb| [AD,BD,CD,DD]=diagonalForm(A,B,C,D)| implementiert werden, die ein gegebenes System in Diagonalform transformiert.
\lstinputlisting[style=Matlab_colored,caption={Code der Diagonalisierungsfunktion}, label={Code_diagonalForm}]{Codes/diagonalForm.m}

Zusätzlich soll das System im zweiten Arbeitspunkt anhand dieser Funktion und mit der Funktion \verb|canon| auf Diagonalform transformiert werden.

Die Ergebnisse der Funktion \verb|diagonalForm| sind hier wie folgt:

\begin{itemize}
	\item $\bf{A2D}= \begin{pmatrix}
	-16,0744&0&0&0\\
	0&16,0744&0&0\\
	0&0&-5,9929&0\\
	0&0&0&5,9929
	\end{pmatrix}$
	
	\item $\bf{B_{AP3}}= \begin{pmatrix}
	138,1293\\
	138,1293\\
	-21,3960\\
	21,3960
	\end{pmatrix}$
	
	\item $\bf{C_{AP3}}= \begin{pmatrix}
	-0,0267&0,0267&0,0943&0,0943\\
	0,0560&-0,0560&0,1349&0,1349
	\end{pmatrix}$
	
	\item $\bf{D_{AP3}}= \begin{pmatrix}
	0\\
	0
	\end{pmatrix}$
\end{itemize}	
	
Die Diagonalisierung mittels der Funktion \verb|canon| führt zu folgendem Ergebnis:

\begin{itemize}	
	\item $\bf{A2D}= \begin{pmatrix}
	-16,07&0&0&0\\
	0&-5,993&0&0\\
	0&0&16,07&0\\
	0&0&0&5,993
	\end{pmatrix}$
	
	\item $\bf{B2D}= \begin{pmatrix}
	2,535\\
	-0,7024\\
	2,535\\
	0,7024
	\end{pmatrix}$
	
	\item $\bf{C2D}= \begin{pmatrix}
	-1,456&2,873&1,456&2,873\\
	3,053&4,109&-3,053&4,109
	\end{pmatrix}$
	
	\item $\bf{D2D}= \begin{pmatrix}
	0\\
	0
	\end{pmatrix}$	
	
\end{itemize}

\paragraph{Welche Unterschiede sind zu erkennen? Wie lassen sie sich erklären?}
(TEXT)

Als nächstes soll das System im ersten Arbeitspunkt auf Modalform transformiert werden. Das in Modalform transormierte System im ersten Arbeitspunkt sieht wie folgt aus:

%gaanz kleine Zahlen gebe ich im Folgenden als Null an
\begin{itemize}	
	\item $\bf{A2D}= \begin{pmatrix}
	0&16,07&0&0\\
	-16,07&0&0&0\\
	0&0&0&5,993\\
	0&0&-5,993&0
	\end{pmatrix}$
	
	\item $\bf{B2D}= \begin{pmatrix}
	5,374\\
	0\\
	0\\
	-2,143
	\end{pmatrix}$
	
	\item $\bf{C2D}= \begin{pmatrix}
	0&-1,374&-1,883&0\\
	0&2,881&-2,694&0
	\end{pmatrix}$
	
	\item $\bf{D2D}= \begin{pmatrix}
	0\\
	0
	\end{pmatrix}$	
	
\end{itemize}




\section{Untersuchung von Steuerbarkeit und Beobachtbarkeit}
Hier sollen die im Skript vorgestellten Überprüfungsverfahren unter Verwendung der im Rahmen des Versuchs erstellten Funktionen implementiert werden. Die Funktionen für die Überprüfungsverfahren sollen möglichst allgemein verwendbar sein.

Die Überprüfungsverfahren nach Kalman:
\lstinputlisting[style=Matlab_colored,caption={Code der Steuerbarkeitsfunktion nach Kalman}, label={Code_diagonalForm}]{Codes/checkCtrbKalman.m}
\lstinputlisting[style=Matlab_colored,caption={Code der Beobachtbarbarkeitsfunktion nach Kalman}, label={Code_diagonalForm}]{Codes/checkObsvKalman.m}

Vergleich mit ctrb und obsv

\lstinputlisting[style=Matlab_colored,caption={Code der Steuerbarkeitsfunktion nach Gilbert}, label={Code_diagonalForm}]{Codes/checkCtrbGilbert.m}
\lstinputlisting[style=Matlab_colored,caption={Code der Beobachtbarbarkeitsfunktion nach Gilbert}, label={Code_diagonalForm}]{Codes/checkObsvGilbert.m}

\lstinputlisting[style=Matlab_colored,caption={Code der Steuerbarkeitsfunktion nach Hautus}, label={Code_diagonalForm}]{Codes/checkCtrbKalman.m}
\lstinputlisting[style=Matlab_colored,caption={Code der Beobachtbarbarkeitsfunktion nach Hautus}, label={Code_diagonalForm}]{Codes/checkObsvKalman.m}
\end{document}
